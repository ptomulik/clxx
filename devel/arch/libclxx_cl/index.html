---
layout: page
title: "The libclxx library"
description: ""
---
{% include JB/setup %}

<p><figure>
<img src="{{BASE_PATH}}/img/libclxx-architecture.svg" width="460" height="320" border="0" usemap="#libclxx-architecture.map" />
<figcaption>Fig. 1 Architecture of the <b>libclxx</b> library.</figcaption>
</figure></p>

<map name="libclxx-architecture.map">
<!-- #$-:Image map file created by GIMP Image Map plug-in -->
<!-- #$-:GIMP Image Map plug-in by Maurits Rijk -->
<!-- #$-:Please do not edit lines starting with "#$" -->
<!-- #$VERSION:2.3 -->
<!-- #$AUTHOR:PaweÅ‚ Tomulik -->
<area shape="rect" coords="46,45,172,102" alt="libclxx-platform_layer" target="map-libclxx-platform_layer" href="{{BASE_PATH}}/devel/arch/libclxx/platform_layer.html" />
<area shape="rect" coords="178,44,383,103" alt="libclxx_runtime" target="map-libclxx_runtime" href="{{BASE_PATH}}/devel/arch/libclxx/runtime.html" />
<area shape="rect" coords="44,116,383,159" alt="clxx functions + clxx types &amp; enums" target="map-libclxx-functions_types" href="{{BASE_PATH}}/devel/arch/libclxx/functions_types.html" />
</map>

<p>The sole purpose of <a href="{{BASE_PATH}}/devel/arch/libclxx/">libclxx</a> is to expose the
functionality of the <a href="https://www.khronos.org/opencl/">OpenCL</a> API
in an object-oriented way. The library is split into two sublayers:</p>
<ul>
  <li>the upper layer consists of
  <a href="{{BASE_PATH}}/devel/arch/libclxx/platform_layer.html">platform layer</a> block and the
  <a href="{{BASE_PATH}}/devel/arch/libclxx/runtime.html">runtime</a> block. These blocks
  expose the OpenCL API described in chapters 4 (The OpenCL Platform Layer) and
  5 (The OpenCL Runtime) of the OpenCL standard respectively in an
  object-oriented, easy to use way.</li>
  <li>the lower layer &mdash; <a href="{{BASE_PATH}}/devel/arch/libclxx/functions_types.html">
  clxx functions + clxx types & enums</a> &mdash; contains basic C++ types,
  enums and functions corresponding to bare OpenCL types, constants and
  functions. These functions have two main purposes - (1) to convert OpenCL
  error codes into C++ exceptions, and (2) to pass all calls to the OpenCL
  functions through our thin OpenCL mocks layer.  In normal operation, all the
  calls are forwarded to OpenCL. When unit-testing, however, the original OpenCL
  functions are replaced with our own
  <a href="http://cxxtest.com/guide.html#mock">mocks</a>.</li>
</ul>

<p><b>OpenCL mocks</b> contains "replacements" for the original OpenCL
functions. They're used for unit-testing. When unit-testing the
<a href={{BASE_PATH}}/devel/arch/libclxx/">libclxx</a>, specially crafted mocks are called
internally instead of OpenCL functions. This way, tests may be performed even
on platforms having no OpenCL devices configured.</p>
